{"title":"","type":"page","uid":"1cd19fc71517798e2fa5b7457d1fb06e","text":"var stop, staticx; var img = new Image(); img.src = \"https://img.cdn.nesxc.com/2022/02/202202251325420webp\"; function Sakura(x, y, s, r, fn)...","date":"2025-06-25T16:07:58.093Z","updated":"2025-06-25T16:07:58.093Z","comments":true,"path":"api/pages/js/leaves.js","covers":null,"content":"var stop, staticx;\nvar img = new Image();\nimg.src = \"https://img.cdn.nesxc.com/2022/02/202202251325420webp\";\n\nfunction Sakura(x, y, s, r, fn) {\n    this.x = x;\n    this.y = y;\n    this.s = s;\n    this.r = r;\n    this.fn = fn\n}\nSakura.prototype.draw = function(cxt) {\n    cxt.save();\n    var xc = 20 * this.s / 2;\n    cxt.translate(this.x, this.y);\n    cxt.rotate(this.r);\n    cxt.drawImage(img, 0, 0, 20 * this.s, 20 * this.s);\n    cxt.restore()\n};\nSakura.prototype.update = function() {\n    this.x = this.fn.x(this.x, this.y);\n    this.y = this.fn.y(this.y, this.y);\n    this.r = this.fn.r(this.r);\n    if (this.x > window.innerWidth || this.x < 0 || this.y > window.innerHeight || this.y < 0) {\n        this.r = getRandom(\"fnr\");\n        if (Math.random() > 0.4) {\n            this.x = getRandom(\"x\");\n            this.y = 0;\n            this.s = getRandom(\"s\");\n            this.r = getRandom(\"r\")\n        } else {\n            this.x = window.innerWidth;\n            this.y = getRandom(\"y\");\n            this.s = getRandom(\"s\");\n            this.r = getRandom(\"r\")\n        }\n    }\n};\nSakuraList = function() {\n    this.list = []\n};\nSakuraList.prototype.push = function(sakura) {\n    this.list.push(sakura)\n};\nSakuraList.prototype.update = function() {\n    for (var i = 0, len = this.list.length; i < len; i++) {\n        this.list[i].update()\n    }\n};\nSakuraList.prototype.draw = function(cxt) {\n    for (var i = 0, len = this.list.length; i < len; i++) {\n        this.list[i].draw(cxt)\n    }\n};\nSakuraList.prototype.get = function(i) {\n    return this.list[i]\n};\nSakuraList.prototype.size = function() {\n    return this.list.length\n};\n\nfunction getRandom(option) {\n    var ret, random;\n    switch (option) {\n        case \"x\":\n            ret = Math.random() * window.innerWidth;\n            break;\n        case \"y\":\n            ret = Math.random() * window.innerHeight;\n            break;\n        case \"s\":\n            ret = Math.random();\n            break;\n        case \"r\":\n            ret = Math.random() * 4;\n            break;\n        case \"fnx\":\n            random = -0.5 + Math.random() * 1;\n            ret = function(x, y) {\n                return x + 0.5 * random - 1.7\n            };\n            break;\n        case \"fny\":\n            random = 1.5 + Math.random() * 0.7;\n            ret = function(x, y) {\n                return y + random\n            };\n            break;\n        case \"fnr\":\n            random = Math.random() * 0.03;\n            ret = function(r) {\n                return r + random\n            };\n            break\n    }\n    return ret\n}\n\nfunction startSakura() {\n    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame;\n    var canvas = document.createElement(\"canvas\"),\n        cxt;\n    staticx = true;\n    canvas.height = window.innerHeight;\n    canvas.width = window.innerWidth;\n    canvas.setAttribute(\"style\", \"position: fixed;left: 0;top: 0;pointer-events: none;\");\n    canvas.setAttribute(\"id\", \"canvas_sakura\");\n    document.getElementsByTagName(\"body\")[0].appendChild(canvas);\n    cxt = canvas.getContext(\"2d\");\n    var sakuraList = new SakuraList();\n    for (var i = 0; i < 50; i++) {\n        var sakura, randomX, randomY, randomS, randomR, randomFnx, randomFny;\n        randomX = getRandom(\"x\");\n        randomY = getRandom(\"y\");\n        randomR = getRandom(\"r\");\n        randomS = getRandom(\"s\");\n        randomFnx = getRandom(\"fnx\");\n        randomFny = getRandom(\"fny\");\n        randomFnR = getRandom(\"fnr\");\n        sakura = new Sakura(randomX, randomY, randomS, randomR, {\n            x: randomFnx,\n            y: randomFny,\n            r: randomFnR\n        });\n        sakura.draw(cxt);\n        sakuraList.push(sakura)\n    }\n    stop = requestAnimationFrame(function() {\n        cxt.clearRect(0, 0, canvas.width, canvas.height);\n        sakuraList.update();\n        sakuraList.draw(cxt);\n        stop = requestAnimationFrame(arguments.callee)\n    })\n}\nwindow.onresize = function() {\n    var canvasSnow = document.getElementById(\"canvas_snow\")\n};\nimg.onload = function() {\n    startSakura()\n};\n\nfunction stopp() {\n    if (staticx) {\n        var child = document.getElementById(\"canvas_sakura\");\n        child.parentNode.removeChild(child);\n        window.cancelAnimationFrame(stop);\n        staticx = false\n    } else {\n        startSakura()\n    }\n};\n\n","count_time":{"symbolsCount":"4.4k","symbolsTime":"4 mins."},"toc":"","data":[]}